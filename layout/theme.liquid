{% comment %}
@MutationCompatible: CyberLotus, ObsidianBloom
@StrategyProfile: quantum-entangled
{% endcomment %}
// Generated by VoidBloom Neural Forge v2.2.1 //
// Entangled: 2025-04-17T17:40:07.5534912-07:00 //
<!DOCTYPE html>
<html lang="{{ shop.locale }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="{{ settings.theme_color | default: '#001a33' }}">
  <link rel="canonical" href="{{ canonical_url }}">
  
  {% assign csp_nonce_value = content_for_header | split: 'CSP-NONCE=' | last | split: '"' | first %}
  
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.shopify.com https://*.shopify.com 'nonce-{{ csp_nonce_value }}'; style-src 'self' https://cdn.shopify.com https://*.shopify.com 'nonce-{{ csp_nonce_value }}' 'unsafe-inline'; img-src 'self' https://cdn.shopify.com https://*.shopify.com data: blob:; font-src 'self' https://cdn.shopify.com https://*.shopify.com; connect-src 'self' https://*.shopify.com; frame-src 'self' https://*.shopify.com; object-src 'none';">
  
  {%- if settings.favicon != blank -%}
    <link rel="shortcut icon" href="{{ settings.favicon | img_url: '32x32' }}" type="image/png">
  {%- endif -%}

  {%- capture seo_title -%}
    {%- if template.name == 'index' -%}
      {{ page_title }}{% if settings.site_name_append %} - {{ shop.name }}{% endif %}
    {%- elsif template.name == 'product' -%}
      {{ product.title }} - {{ shop.name }}
    {%- elsif template.name == 'collection' -%}
      {{ collection.title }} - {{ shop.name }}
    {%- elsif template.name == 'article' -%}
      {{ article.title }} - {{ shop.name }}
    {%- elsif template.name == 'page' -%}
      {{ page.title }} - {{ shop.name }}
    {%- elsif template.name == 'cart' -%}
      {{ 'general.cart.title' | t }} - {{ shop.name }}
    {%- elsif template.name == 'search' -%}
      {% if search.performed %}{{ 'search.results.title' | t: terms: search.terms }} - {{ shop.name }}{% else %}{{ 'search.title' | t }} - {{ shop.name }}{% endif %}
    {%- else -%}
      {{ page_title }}
    {%- endif -%}
  {%- endcapture -%}

  <title>{{ seo_title }}</title>

  {% if page_description %}
    <meta name="description" content="{{ page_description | escape }}">
  {% endif %}

  <!-- Social Meta Tags -->
  {% render 'meta-social' %}

  <!-- Styles -->
  {{ 'bloom.css' | asset_url | stylesheet_tag }}
  {{ 'quantum-featured.css' | asset_url | stylesheet_tag }}
  
  <!-- Scripts -->
  {{ 'neural-bus.js' | asset_url | script_tag: defer: true, nonce: csp_nonce_value }}
  {{ 'ritual-engine.js' | asset_url | script_tag: defer: true, nonce: csp_nonce_value }}
  {{ 'theme.js' | asset_url | script_tag: defer: true, nonce: csp_nonce_value }}
  {{ 'cart-system.js' | asset_url | script_tag: defer: true, nonce: csp_nonce_value }}
  
  <!-- Quantum Layer (for advanced effects) -->
  {% render 'quantum-layer' %}

  <!-- Pass Shopify data to script -->
  <script nonce="{{ csp_nonce_value }}">
    window.shopifyData = {
      shop: {
        name: {{ shop.name | json }},
        description: {{ shop.description | json }},
        domain: {{ shop.domain | json }}
      },
      {% if customer %}
      customer: {
        id: {{ customer.id | json }},
        firstName: {{ customer.first_name | json }},
        metafields: {}
      },
      {% else %}
      customer: null,
      {% endif %}
      cart: null
    };
    
    // Initialize cart data retrieval
    fetch('/cart.js')
      .then(response => response.json())
      .then(cartData => {
        window.shopifyData.cart = cartData;
      });
  </script>

  <!-- Header Scripts -->
  {{ content_for_header }}
  
  <!-- CSP Nonce -->
  <meta property="csp-nonce" content="{{ csp_nonce_value }}">
</head>

<body class="{% if settings.animation_reduce_motion %}reduce-motion{% endif %} {{ template.name }} {{ template.suffix }}" 
      data-template="{{ template.name }}{% if template.suffix %}-{{ template.suffix }}{% endif %}"
      data-mutation-profile="{{ settings.mutation_profile | default: 'VoidBloom' }}">

  <!-- Skip to content -->
  <a class="skip-to-content" href="#MainContent">{{ 'accessibility.skip_to_content' | t }}</a>

  <!-- Header -->
  {% section 'header' %}

  <!-- Main content area -->
  <main id="MainContent" class="content-for-layout" role="main">
    {{ content_for_layout }}
  </main>

  <!-- Footer -->
  {% section 'footer' %}

  <!-- Cart Drawer - Loaded via AJAX -->
  <div id="CartDrawer" class="drawer cart-drawer" aria-modal="true" aria-label="{{ 'general.cart.title' | t }}" data-quantum-drawer="cart"></div>
  
  <!-- Mobile Menu Drawer -->
  <div id="MobileMenuDrawer" class="drawer mobile-menu-drawer" aria-modal="true" aria-label="{{ 'general.navigation.title' | t }}" data-quantum-drawer="menu"></div>
  
  <!-- Quantum Notifications -->
  <div id="QuantumNotifications" class="quantum-notifications" aria-live="polite"></div>
  
  <!-- Modal Container -->
  <div id="ModalContainer" class="modal-container"></div>
</body>
</html>